#include <stdio.h>
#include <string.h>
#include <math.h>
#include <stdlib.h>
int s1,s2;
int top1 = -1,top2 = -1;
void push1(int* stack1,int val){
    if(top1 == s1-1)
        printf("Overflow\n");
    else{
        stack1[++top1]=val; 
    }
}
void push2(int* stack2,int val){
    if(top2 == s2-1)
        printf("Overflow\n");
    else{
        stack2[++top2]=val;
    }
}
void pop1(int* stack1){
    if(top1 == -1)
        printf("Underflow\n");
    else{
        printf("%d\n",stack1[top1]);
        top1--;
    }
}
void pop2(int* stack2){
    if(top2 == -1)
        printf("Underflow\n");
    else{
        printf("%d\n",stack2[top2]);
        top2--;
    }
}
void peek1(int* stack1){
    if(top1 == -1)
        printf("Underflow\n");
    else{
        printf("%d\n",stack1[top1]);
    }
}
void peek2(int* stack2){
    if(top2 == -1)
        printf("Underflow\n");
    else{
        printf("%d\n",stack2[top2]);
    }
}
void display1(int* stack1){
    if(top1 == -1)
        printf("Empty\n");
    else{
        for(int i=top1;i>=0;i--){
            printf("%d ",stack1[i]);
        }
        printf("\n");
    }
}
void display2(int* stack2){
    if(top2 == -1)
        printf("Empty\n");
    else{
        for(int i=top2;i>=0;i--){
            printf("%d ",stack2[i]);
        }
        printf("\n");
    }
}

int main() {
    int oper,num,val;
    char str[10];
    scanf("%d %d",&s1,&s2);
    int stack1[s1],stack2[s2];
    scanf("%d",&oper);
    for(int i=0;i<oper;i++){
        scanf(" %s",str);
        if(strcmp(str,"PUSH")==0){
            scanf("%d %d",&num,&val);
            if(num == 1)
                push1(stack1,val);
            else
                push2(stack2,val);
        }
        else if(strcmp(str,"POP")==0){
            scanf("%d",&num);
            if(num == 1)
                pop1(stack1);
            else
                pop2(stack2);
        }
        else if(strcmp(str,"PEEK")==0){
            scanf("%d",&num);
            if(num == 1)
                peek1(stack1);
            else
                peek2(stack2);
        } 
        else if(strcmp(str,"DISPLAY")==0){
            scanf("%d",&num);
            if(num == 1)
                display1(stack1);
            else
                display2(stack2);
        }
    }
    return 0;
}
